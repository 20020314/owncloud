function rcube_mail_ui(){function f(a){m||(m=rcmail.local_storage_get_item("prefs.larry",{}));if(null==m[a]){var e=rcmail.get_cookie(a);null!=e&&(m[a]=e,rcmail.local_storage_set_item("prefs.larry",m)&&rcmail.set_cookie(a,e,new Date))}return m[a]}function n(a,e){m[a]=e;if(!rcmail.local_storage_set_item("prefs.larry",m)){var c=new Date;c.setYear(c.getFullYear()+1);rcmail.set_cookie(a,e,c)}}function r(a){a=a?10:0;rcmail.resize_timeout&&window.clearTimeout(rcmail.resize_timeout);rcmail.resize_timeout=
window.setTimeout(function(){"mail"==rcmail.env.task&&("show"==rcmail.env.action||"preview"==rcmail.env.action?u():"compose"==rcmail.env.action&&s());$("body.iframe .footerleft").each(function(){var a=$(this),c=$(document.body),b=a.hasClass("floating"),g=c.outerHeight(!0)>$(window).height();g!=b&&(b=g?"addClass":"removeClass",a[b]("floating"),c[b]("floatingbuttons"))})},a)}function h(a){var e=$(a.object).siblings("div");e.length&&$(a.object).insertBefore(e.first());if("error"==a.type&&"login"!=rcmail.env.task){rcmail.hide_message(a.object);
k.message_timer&&window.clearTimeout(k.message_timer);k.messagedialog||(k.messagedialog=$("<div>").addClass("popupdialog").hide());var e=a.message,c=function(){k.messagedialog.is(":visible")&&k.messagedialog.dialog("destroy").hide()};k.messagedialog.is(":visible")&&(e=k.messagedialog.html()+"<p>"+a.message+"</p>");k.messagedialog.html(e).dialog({resizable:!1,closeOnEscape:!0,dialogClass:"popupmessage "+a.type,title:p.errortitle,close:c,position:["center","center"],hide:{effect:"fadeOut"},width:420,
minHeight:90}).show();k.messagedialog.closest("div[role=dialog]").attr("role","alertdialog");0<a.timeout&&(k.message_timer=window.setTimeout(c,a.timeout))}}function u(){$("#messagecontent").css("top",$("#messageheader").outerHeight()+1+"px");$("#message-objects div a").addClass("button");$("#attachment-list li").length||($("div.rightcol").hide().attr("aria-hidden","true"),$("div.leftcol").css("margin-right","0"))}function b(a){}function d(a){}function q(a){if("TEXTAREA"==a.nodeName){var e=$(a),c=
a.scrollHeight;e.css("height",14*(80<a.value.length&&21<c?2:1)+"px");s()}}function s(){var a=$("#composebody"),e=$("#compose-content"),c=$("#composeview-bottom"),b,g;b=e.height()-c.position().top;g=300-b;c.height(Math.max(300,b));e.css("overflow",0<g?"auto":"hidden");e=a.parent().width()-5;c=a.parent().height()-8;a.width(e).height(c);$("#composebodycontainer > div").width(e+8);$("#composebody_ifr").height(c+4-$("div.mce-toolbar").height());$("#googie_edit_layer").width(e).height(c);a=$("#directorylist");
a.length&&$("#compose-contacts .scroller").css("top",a.position().top+a.outerHeight())}function z(a){var e=$("#quotadisplay"),c=$("#quotamenu"),b=a.total?24*Math.ceil(a.percent/100*20):0;a.total&&480==b&&100>a.percent&&(b-=24);e.css("background-position","0 -"+b+"px");a.table&&(c.length||(c=$('<div id="quotamenu" class="popupmenu">').appendTo($("body"))),c.html(a.table),e.css("cursor","pointer").off("click").on("click",function(a){return rcmail.command("menu-open","quotamenu",a.target,a)}))}function D(a){$(".boxtitle a.search",
a).click(function(e){var c=$(".boxtitle",a),b=$(".listsearchbox",a),g=b.is(":visible")?-1:1,d=34+($("select",b).length?22:0);b.slideToggle({duration:160,progress:function(e,b){0>g&&(b=1-b);$(".scroller",a).css("top",c.outerHeight()+d*b+"px")},complete:function(){b.toggleClass("expanded");b.is(":visible")?(b.find("input[type=text]").focus(),d=34+($("select",b).length?$("select",b).outerHeight()+4:0),$(".scroller",a).css("top",c.outerHeight()+d+"px")):$("a.reset",b).click()}});return!1})}function E(a){"reply-list"==
a.command&&1==rcmail.env.reply_all_mode&&(a=rcmail.gettext(a.status?"replylist":"replyall"),"preview"==rcmail.env.action?$("a.button.replyall").attr("title",a):$("a.button.reply-all").text(a).attr("title",a))}function A(a,e){var c=v[a]=$("#"+a);c.appendTo(document.body);c.length&&(t[a]=$.extend(t[a]||{},e||{}))}function F(){$("#preview-shortheaders").toggle();var a=$("#preview-allheaders").toggle(),e=$("a#previewheaderstoggle");a.is(":visible")?e.attr("href","#hide").removeClass("add").addClass("remove").attr("aria-expanded",
"true"):e.attr("href","#details").removeClass("remove").addClass("add").attr("aria-expanded","false");n("previewheaders",a.is(":visible")?"1":"0")}function w(a,e){if(e||!$("#mail"+a+"mode").hasClass("disabled"))$("#maillistmode, #mailthreadmode").removeClass("selected").attr("tabindex","0").attr("aria-disabled","false"),$("#mail"+a+"mode").addClass("selected").attr("tabindex","-1").attr("aria-disabled","true")}function G(a){if(a&&"messagelistmenu"==a.name)K(a);else if(a){var e=t[a.name]||{},c=$(e.link||
"#"+a.name+"link"),b=a.obj&&a.obj.is(":visible");if(a.obj&&b&&c.length){var g=c.parent();$(window);g.hasClass("dropbutton")&&(c=g);if(e.above||c.hasClass("dropbutton"))g=c.offset(),a.obj.css({left:g.left+"px",top:g.top+(e.above?-a.obj.height():c.outerHeight())+"px"})}a.obj&&e.iconized&&a.obj.children("ul").addClass("iconized");a.obj&&e.editable&&a.obj.attr("data-editable","true");"function"==typeof e.callback&&e.callback(b,a)}}function L(a,e){var b=a.parentNode.id.replace(/^attach/,"");$("#attachmenuopen").unbind("click").attr("onclick",
"").click(function(a){return rcmail.command("open-attachment",b,this)});$("#attachmenudownload").unbind("click").attr("onclick","").click(function(){rcmail.command("download-attachment",b,this)});t.attachmentmenu.link=a;rcmail.command("menu-open",{menu:"attachmentmenu",id:b},a,e)}function K(a){var b=$("#listoptions");b.is(":visible")?b.dialog("close",a.originalEvent):($('input[name="sort_col"][value="'+rcmail.env.sort_col+'"]').prop("checked",!0),$('input[name="sort_ord"][value="DESC"]').prop("checked",
"DESC"==rcmail.env.sort_order),$('input[name="sort_ord"][value="ASC"]').prop("checked","DESC"!=rcmail.env.sort_order),$('input[name="list_col[]"]').each(function(){$(this).prop("checked",-1!=$.inArray(this.value,rcmail.env.listcols))}),b.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:null,open:function(a){setTimeout(function(){b.find("a, input:not(:disabled)").not("[aria-disabled=true]").first().focus()},100)},close:function(a){b.dialog("destroy").hide();a.originalEvent&&rcube_event.is_keyboard(a.originalEvent)&&
$("#listmenulink").focus()},minWidth:500,width:b.width()+25}).show())}function M(a){$("#listoptions").dialog("close");rcube_event.is_keyboard(a.originalEvent)&&$("#listmenulink").focus();a=$('input[name="sort_col"]:checked').val();var b=$('input[name="sort_ord"]:checked').val(),c=$('input[name="list_col[]"]:checked').map(function(){return this.value}).get();rcmail.set_list_options(c,a,b,rcmail.env.threading)}function N(a){a=$("#contacts-table");var b=a.parent().css("overflow","hidden");a.clone().css({position:"absolute",
top:"0",left:"0",width:a.width()+"px","z-index":10}).appendTo(b).animate({left:-(a.width()+5)+"px"},300,"swing",function(){$(this).remove();b.css("overflow","auto")})}function O(a){a=$("#contacts-table");var b=a.parent().css("overflow","hidden"),c=a.clone().appendTo(b);a.css({position:"absolute",top:"0",left:-(a.width()+5)+"px",width:a.width()+"px",height:a.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){c.remove();$(this).css({position:"relative",left:"0",width:"100%",height:"auto",
"z-index":1});b.css("overflow","auto")})}function x(a){var b=$("#upload-dialog");b.is(":visible")?b.dialog("close"):("compose"!=rcmail.env.action||b.data("extended")||($("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($('input[type="file"]',b).parent()).click(H),b.data("extended",!0)),b.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:b.attr("title"),open:function(a){document.all||$("input[type=file]",b).first().click()},close:function(){try{$("#upload-dialog form").get(0).reset()}catch(a){}b.dialog("destroy").hide();
$("div.addline",b).remove()},width:480}).show())}function H(a){a=$(this).parent();a=a.clone().addClass("addline").insertAfter(a);a.children(".iconlink").click(H);a.children("input").val("");document.all||$("input[type=file]",a).click()}function y(a,b){var c=$("#compose-"+a);if(!c.is(":visible"))return B[a]&&!b&&$("#_"+a).val(B[a]),c.show(),$("#"+a+"-link").hide(),s(),$("input,textarea",c).focus(),!1}function I(a,b){var c=$(a),d=c.get(0).id,g=c.children("fieldset");if(g.length){d||(d="rcmtabcontainer",
c.attr("id",d));var f=$("<ul>").addClass("tabsbar").prependTo(c);g.each(function(a){var b,c=$(this),g=c.children("legend"),e=d+"-t"+a;b=$("<a>").text(g.text()).attr("href","#"+e);a=$("<li>").addClass("tablink");g.remove();c.attr("id",e);a.append(b).appendTo(f)});c.tabs({active:b||0,heightStyle:"content",activate:function(a,b){r()}})}}var p={},v={},t={forwardmenu:{editable:1},searchmenu:{editable:1,callback:function(a){if(a&&rcmail.env.search_mods){var b,c;a=$('input:checkbox[name="s_mods[]"]',v.searchmenu);
var d=rcmail.env.mailbox,g=rcmail.env.search_mods,f=rcmail.env.search_scope||"base";"mail"==rcmail.env.task?("all"==f&&(d="*"),g=g[d]?g[d]:g["*"],c="text",$('input:radio[name="s_scope"]').prop("checked",!1).filter("#s_scope_"+f).prop("checked",!0)):c="*";if(g[c])a.map(function(){this.checked=!0;this.disabled=this.value!=c});else for(b in a.prop("disabled",!1).prop("checked",!1),g)$("#s_mod_"+b).prop("checked",!0)}}},attachmentmenu:{},listoptions:{editable:1},groupmenu:{above:1},mailboxmenu:{above:1},
spellmenu:{callback:function(a,b){var c,d,g,f=rcmail.spellcheck_lang(),q=$("ul",b.obj);if(!q.length){q=$('<ul class="toolbarmenu selectable" role="menu">');for(c in rcmail.env.spell_langs)g=$('<li role="menuitem">'),d=$('<a href="#'+c+'" tabindex="0"></a>').text(rcmail.env.spell_langs[c]).addClass("active").data("lang",c).bind("click keypress",function(a){if("keypress"!=a.type||13==rcube_event.get_keycode(a))return rcmail.spellcheck_lang_set($(this).data("lang")),rcmail.hide_menu("spellmenu",a),!1}),
d.appendTo(g),g.appendTo(q);q.appendTo(b.obj)}$("li",q).each(function(){var a=$("a",this);a.data("lang")==f?a.addClass("selected").attr("aria-selected","true"):a.hasClass("selected")&&a.removeClass("selected").removeAttr("aria-selected")})}},"folder-selector":{iconized:1}},k=this,l,B={},m;this.set=function(a,b){p[a]=b};this.init=function(){rcmail.addEventListener("message",h);$("#taskbar a").each(function(a,b){$(b).append('<span class="tooltip">'+$(".button-inner",this).html()+"</span>")});$("#taskbar .minmodetoggle").click(function(a){a=
$(document.body).toggleClass("minimal").hasClass("minimal");n("minimalmode",a?1:0);$(window).resize()});if("mail"==rcmail.env.task){rcmail.addEventListener("menu-open",G).addEventListener("menu-close",G).addEventListener("menu-save",M).addEventListener("responseafterlist",function(a){w(rcmail.env.threading?"thread":"list",!0)}).addEventListener("responseaftersearch",function(a){w(rcmail.env.threading?"thread":"list",!0)});var a=$("#dragmessagemenu");a.length&&(rcmail.gui_object("dragmenu","dragmessagemenu"),
v.dragmenu=a);if("show"==rcmail.env.action||"preview"==rcmail.env.action)rcmail.addEventListener("enable-command",E).addEventListener("aftershow-headers",function(){u()}).addEventListener("afterhide-headers",function(){u()}),$("#previewheaderstoggle").click(function(a){F();return!1}),$("#attachment-list > li").each(function(){$(this).append($('<a class="drop" tabindex="0" aria-haspopup="true">Show options</a>').bind("click keypress",function(a){if("keypress"!=a.type||13==rcube_event.get_keycode(a))return L(this,
a),!1}))}),"1"==f("previewheaders")&&F();else if("compose"==rcmail.env.action){rcmail.addEventListener("aftersend-attachment",x).addEventListener("add-recipient",function(a){y(a.field,!0)}).addEventListener("aftertoggle-editor",function(a){window.setTimeout(function(){s()},200);a&&a.mode&&$("select[name='editorSelector']").val(a.mode)});for(var e,c,C=["cc","bcc","replyto","followupto"],a=0;a<C.length;a++)e=C[a],c=$("#_"+e),c.length&&(c.on("change",{v:e},function(a){this.value&&y(a.data.v,!0)}),""!=
c.val()&&y(e,!0));$("#composeoptionstoggle").click(function(a){var b=$("#composeoptions").toggle().is(":visible");$("#composeoptionstoggle").toggleClass("remove").attr("aria-expanded",b?"true":"false");s();n("composeoptions",b?"1":"0");rcube_event.is_keyboard(a)||this.blur();return!1}).css("cursor","pointer");"0"!==f("composeoptions")&&$("#composeoptionstoggle").click();$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(a){q(this)}).change();rcmail.addEventListener("autocomplete_insert",
function(a){q(a.field)});(a=rcmail.opener())&&"compose"==a.env.action&&$("#composeoptionstoggle",opener.document).hasClass("remove")&&$("#composeoptionstoggle").click();(new rcube_splitter({id:"composesplitterv",p1:"#composeview-left",p2:"#composeview-right",orientation:"v",relative:!0,start:206,min:170,size:12,render:s})).init()}else"list"!=rcmail.env.action&&rcmail.env.action?"get"==rcmail.env.action&&(new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",
orientation:"v",relative:!0,start:226,min:150,size:12})).init():(a=$("#mailpreviewframe").is(":visible"),$("#mailpreviewtoggle").addClass(a?"enabled":"closed").attr("aria-expanded",a?"true":"false").click(function(a){a=$(a.target);var b=$("#mailpreviewframe"),c=!b.is(":visible");l.pos||parseInt(f("mailviewsplitter")||320);var e;b.toggle();a.toggleClass("enabled closed").attr("aria-expanded",c?"true":"false");c?($("#mailview-top").removeClass("fullheight").css({bottom:"auto"}),$("#mailview-bottom").css({height:"auto"}).show(),
rcmail.env.contentframe="messagecontframe",(e=rcmail.message_list.get_single_selection())&&rcmail.show_message(e,!1,!0),l.handle?(l.handle.show(),l.resize()):l.init()):(rcmail.env.contentframe=null,rcmail.show_contentframe(!1),$("#mailview-top").addClass("fullheight").css({height:"auto",bottom:"0px"}),$("#mailview-bottom").css({top:"auto",height:"0px"}).hide(),l.handle&&l.handle.hide());rcmail.message_list&&(c&&e&&rcmail.message_list.scrollto(e),rcmail.message_list.resize());rcmail.command("save-pref",
{name:"preview_pane",value:c?1:0});return!1}),$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(a){w("list");return!1}),$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(a){w("thread");return!1}),l=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:!0,start:310,min:150,size:12,offset:4}),a&&l.init(),rcmail.addEventListener("setquota",z).addEventListener("enable-command",E).addEventListener("afterimport-messages",
x));$("#mailview-left").length&&(new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:!0,start:206,min:150,size:12,callback:b,render:d})).init()}else"settings"==rcmail.env.task?(rcmail.addEventListener("init",function(){var a="#settingstabpreferences";rcmail.env.action&&(a="#settingstab"+(0<rcmail.env.action.indexOf("identity")?"identities":rcmail.env.action.replace(/\./g,"")));$(a).addClass("selected").children().first().removeAttr("onclick").click(function(){return!1})}),
"folders"==rcmail.env.action)?((new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:!0,start:266,min:180,size:12})).init(),rcmail.addEventListener("setquota",z),D($("#folderslist"))):"identities"==rcmail.env.action?(new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,min:180,size:12})).init():"responses"==rcmail.env.action?(new rcube_splitter({id:"responseviewsplitter",
p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,min:180,size:12})).init():"preferences"!=rcmail.env.action&&rcmail.env.action?"edit-prefs"==rcmail.env.action&&($('<a href="#toggle"></a>').text(p.toggleoptions).attr("title",p.toggleoptions).addClass("advanced-toggle").appendTo("#preferences-details fieldset.advanced legend"),$("#preferences-details fieldset.advanced legend").click(function(a){a=$(this).hasClass("collapsed");$(".advanced-toggle",this).html(a?"&#9650;":
"&#9660;");$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).addClass("collapsed")):(new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:!0,start:266,min:180,size:12})).init():"addressbook"==rcmail.env.task&&(rcmail.addEventListener("afterupload-photo",x).addEventListener("beforepushgroup",N).addEventListener("beforepopgroup",O),""==rcmail.env.action&&((new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",
p2:"#addressview-right",orientation:"v",relative:!0,start:206,min:150,size:12,render:d})).init(),(new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:!0,start:266,min:260,size:12})).init()),a=$("#dragcontactmenu"),a.length&&(rcmail.gui_object("dragmenu","dragcontactmenu"),v.dragmenu=a));$(".tabbed").each(function(a,b){I(b)});$("select.decorated").each(function(){if(bw.opera)$(this).removeClass("decorated");else{var a=$(this),b=a.parent(),c=Math.max(a.height(),
26)-2,e=a.width()-22,d=$("option",this).first().text();""!=$("option:selected",this).val()&&(d=$("option:selected",this).text());var f=$('<a class="menuselector" tabindex="-1"><span class="handle">'+d+"</span></a>").css("position","absolute").offset(a.position()).insertAfter(a);f.children().width(e).height(c).css("line-height",c-1+"px");"absolute"!=b.css("position")&&b.css("position","relative");a.width(f.width()).on(bw.mz?"change keyup":"change",function(){var a=$("option:selected",this).text();
$(this).next().children().text(a)});a.on("focus",function(a){f.addClass("focus")}).on("blur",function(a){f.removeClass("focus")})}});a=$("body.minwidth");a.length&&a.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30);window.onresize=r;r()};this.init_tabs=I;this.show_about=function(a){var b=$("<iframe>").attr("id","aboutframe").attr("src",rcmail.url("settings/about")).attr("frameborder","0").appendTo(document.body),c=Math.floor(0.75*$(window).height()),
d={},g=$("#supportlink");g.length&&(p.supporturl=g.attr("href"))&&(d[g.html()]=function(a){0>p.supporturl.indexOf("mailto:")?window.open(p.supporturl):location.href=p.supporturl});b.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:a?a.title||a.innerHTML:null,close:function(){b.dialog("destroy").remove()},buttons:d,width:640,height:c}).width(640)};this.show_popup=function(a,b,c){!c&&t[a]||A(a,c);c=t[a]||{};c=$(c.link?c.link:"#"+a+"link");var d=c.offset();c.has(".inner")&&(c=c.children(".inner"));
return rcmail.command("menu-open",{menu:a,show:b},c.get(0),$.Event("click",{target:c.get(0),pageX:d.left,pageY:d.top,clientX:d.left,clientY:d.top}))};this.toggle_popup=function(a,b,c){!c&&t[a]||A(a,c);return rcmail.command("menu-open",a,b.target,b)};this.add_popup=A;this.set_searchmod=function(a){var b,c;b=rcmail.env.task;var d=rcmail.env.search_mods,g=rcmail.env.mailbox;"all"==$('input[name="s_scope"]:checked').val()&&(g="*");d||(d={});"mail"==b?(d[g]||(d[g]=rcube_clone_object(d["*"])),c=d[g],b=
"text"):(c=d,b="*");a.checked?c[a.value]=1:delete c[a.value];a.value==b&&$('input:checkbox[name="s_mods[]"]').map(function(){this!=a&&(this.checked=!0,a.checked?(this.disabled=!0,delete c[this.value]):(this.disabled=!1,c[this.value]=1))});rcmail.set_searchmods(c)};this.set_searchscope=function(a){rcmail.set_searchscope(a.value)};this.show_uploadform=x;this.show_header_row=y;this.hide_header_row=function(a){var b=$("#_"+a);B[a]=b.val();b.val("");$("#compose-"+a).hide();$("#"+a+"-link").show();s();
return!1};this.update_quota=z;this.get_pref=f;this.save_pref=n;this.folder_search_init=D;if(window.$&&document.body){var J=f("minimalmode");(parseInt(J)||null===J&&850>$(window).height())&&$(document.body).addClass("minimal");bw.tablet&&$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}}
function rcube_scroller(f,n,r){var h=this;this.list=$(f);this.top=$(n);this.bottom=$(r);this.step_size=6;this.step_time=20;this.delay=500;this.top.mouseenter(function(){rcmail.drag_active&&(h.ts=window.setTimeout(function(){h.scroll("down")},h.delay))}).mouseout(function(){h.ts&&window.clearTimeout(h.ts)});this.bottom.mouseenter(function(){rcmail.drag_active&&(h.ts=window.setTimeout(function(){h.scroll("up")},h.delay))}).mouseout(function(){h.ts&&window.clearTimeout(h.ts)});this.scroll=function(f){var b=
this,d=this.step_size;rcmail.drag_active&&("down"==f&&(d*=-1),this.list.get(0).scrollTop+=d,this.ts=window.setTimeout(function(){b.scroll(f)},this.step_time))}}
function rcube_splitter(f){function n(d){if(bw.konq||bw.chrome||bw.safari)document.body.style.webkitUserSelect="none";b.p1pos=b.relative?b.p1.position():b.p1.offset();b.p2pos=b.relative?b.p2.position():b.p2.offset();b.drag_active=!0;$(document).bind("mousemove."+this.id,r).bind("mouseup."+this.id,h);$("iframe").each(function(b,d){$("<div>").attr("id","iframe-splitter-fix-"+b).addClass("iframe-splitter-fix").css({background:"#fff",width:d.offsetWidth+"px",height:d.offsetHeight+"px",position:"absolute",
opacity:"0.001",zIndex:1E3}).css($(this).offset()).appendTo("body")})}function r(d){if(!b.drag_active)return!1;window.clearTimeout(b.ts);b.ts=window.setTimeout(function(){var f=rcube_event.get_mouse_pos(d);if(b.relative){var h=b.parent.offset();f.x-=h.left;f.y-=h.top}b.horizontal?f.y-b.halfsize>b.p1pos.top&&f.y+b.halfsize<b.p2pos.top+b.p2.outerHeight()&&(b.pos=Math.max(b.min,f.y-Math.max(0,b.offset)),b.pos>b.min&&(b.pos=Math.min(b.pos,b.parent.height()-b.min)),b.resize()):f.x-b.halfsize>b.p1pos.left&&
f.x+b.halfsize<b.p2pos.left+b.p2.outerWidth()&&(b.pos=Math.max(b.min,f.x-Math.max(0,b.offset)),b.pos>b.min&&(b.pos=Math.min(b.pos,b.parent.width()-b.min)),b.resize());b.p1pos=b.relative?b.p1.position():b.p1.offset();b.p2pos=b.relative?b.p2.position():b.p2.offset()},1);return!1}function h(d){if(bw.konq||bw.chrome||bw.safari)document.body.style.webkitUserSelect="auto";$(document).unbind("."+b.id);b.drag_active=!1;$("div.iframe-splitter-fix").remove();b.set_cookie();"function"==typeof b.callback&&b.callback(b);
return bw.safari?!0:rcube_event.cancel(d)}function u(d){b.horizontal?(d=parseInt(b.parent.outerHeight(),10)-parseInt(b.p2[0].style.top,10)-(bw.ie8?2:0),b.p2.css("height",(0<d?d:0)+"px")):(d=parseInt(b.parent.outerWidth(),10)-parseInt(b.p2[0].style.left,10),b.p2.css("width",(0<d?d:0)+"px"))}this.p=f;this.id=f.id;this.horizontal="horizontal"==f.orientation||"h"==f.orientation;this.halfsize=(void 0!==f.size?f.size:10)/2;this.pos=f.start||0;this.min=f.min||20;this.offset=f.offset||0;this.relative=f.relative?
!0:!1;this.drag_active=!1;this.render=f.render;this.callback=f.callback;var b=this;rcube_splitter._instances[this.id]=b;this.init=function(){this.p1=$(this.p.p1);this.p2=$(this.p.p2);this.parent=this.p1.parent();if(this.p1.length&&this.p2.length){this.p1pos=this.relative?this.p1.position():this.p1.offset();this.p2pos=this.relative?this.p2.position():this.p2.offset();this.handle=$("<div>").attr("id",this.id).attr("unselectable","on").attr("role","presentation").addClass("splitter "+(this.horizontal?
"splitter-h":"splitter-v")).appendTo(this.parent).bind("mousedown",n);if(this.horizontal){var b=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:b+"px"})}else b=this.p1pos.left+this.p1.outerWidth(),this.handle.css({left:b+"px",top:"0px"});bw.ie&&$(window).resize(u);(b=this.get_cookie())&&!isNaN(b)?(this.pos=parseFloat(b),this.resize()):this.pos&&(this.resize(),this.set_cookie())}};this.resize=function(){if(this.horizontal){if(this.p1.css("height",Math.floor(this.pos-this.p1pos.top-
Math.floor(this.halfsize))+"px"),this.p2.css("top",Math.ceil(this.pos+Math.ceil(this.halfsize)+2)+"px"),this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px"),bw.ie){var b=parseInt(this.parent.outerHeight(),10)-parseInt(this.p2.css("top"),10)-(bw.ie8?2:0);this.p2.css("height",(0<b?b:0)+"px")}}else this.p1.css("width",Math.floor(this.pos-this.p1pos.left-Math.floor(this.halfsize))+"px"),this.p2.css("left",Math.ceil(this.pos+Math.ceil(this.halfsize))+"px"),this.handle.css("left",
Math.round(this.pos-this.halfsize+this.offset+3)+"px"),bw.ie&&(b=parseInt(this.parent.outerWidth(),10)-parseInt(this.p2.css("left"),10),this.p2.css("width",(0<b?b:0)+"px"));this.p2.resize();this.p1.resize();this.drag_active&&$("iframe").each(function(b,d){var f=$(this).offset();$("#iframe-splitter-fix-"+b).css({top:f.top+"px",left:f.left+"px",width:d.offsetWidth+"px",height:d.offsetHeight+"px"})});"function"==typeof this.render&&this.render(this)};this.get_cookie=function(){return window.UI?UI.get_pref(this.id):
null};this.set_cookie=function(){window.UI&&UI.save_pref(this.id,this.pos)}}rcube_splitter._instances={};rcube_splitter.get_instance=function(f){return rcube_splitter._instances[f]};
